#!/usr/bin/python

import ubot.bot
import ubot.conf
import optparse, os

import sys
sys.excepthook = None

parser = optparse.OptionParser()
parser.add_option('-a', '--address', dest='address', default='tcp:host=localhost,port=11235',
                  help='The address of your session bus', metavar='ADDRESS')
parser.add_option('-c', '--config', dest='config',
                  default=os.path.join('~','.config','ubot','ubot.conf'),
                  help="Specify configfile", metavar="FILE")
parser.add_option('-v', '--verbose', dest='verbose', action='count', default=0,
                  help='Print all messages. Use twice to see raw messages as well')
opts, args = parser.parse_args()
if args:
    parser.error("No arguments allowed")

os.environ['DBUS_SESSION_BUS_ADDRESS'] = os.environ.get('DBUS_STARTER_ADDRESS', opts.address)

bot = ubot.bot.Ubot(ubot.conf.UbotConfig(os.path.expanduser(opts.config)))
bot.verbose = opts.verbose
bot.run()
